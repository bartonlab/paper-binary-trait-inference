# Overview

This repository contains data and scripts for reproducing the results accompanying the manuscript

### Inferring selection for HIV-1 escape from T cell responses using a binary trait model
Yirui Gao<sup>1</sup>, and John P. Barton<sup>2,3,#</sup>

<sup>1</sup> Department of Physics and Astronomy, University of California, Riverside  
<sup>2</sup> Department of Physics and Astronomy, University of Pittsburgh  
<sup>3</sup> Department of Computational and Systems Biology, University of Pittsburgh School of Medicine  
<sup>#</sup> correspondence to [jpbarton@pitt.edu](mailto:jpbarton@pitt.edu)


# Contents

Scripts for generating and analyzing the simulation data can be found in the `Simulation_analyze.ipynb` notebook, and references therein. Scripts for processing and analyzing the HIV-1 data are contained in the `HIV_analyze.ipynb` notebook. Finally, scripts for analysis and figures contained in the manuscript are located in the `figures.ipynb` notebook.  

Due to the large size and number of some files generated by simulations and by the interim analysis of HIV-1 data, some data has been stored in a compressed format using Zenodo. To access the full set of data, navigate to the [Zenodo record](https://zenodo.org/records/10734282). Then download and extract the contents of the archives `HIV-output.tar.gz`, `HIV-input-seq.tar.gz`, and `sim-jobs.tar.gz` into the folders `data/HIV/output`,  `data/HIV/input/sequence`, and `data/simulation/jobs` respectively.

### Running MPL

This repository includes code for inferring selection coefficients and trait coefficients using the marginal path likelihood (MPL) method. Code implementing MPL in C++ is located in the `src/MPL` directory.

### HIV data
Here we combine HIV sequence data from [the Los Alamos National Laboratory HIV Sequence Database](https://www.hiv.lanl.gov/content/index) and immunological data to investigate HIV evolution across 13 individuals. This data is contained in the data/HIV/ directory.

And we use some processed data from [here](https://github.com/bartonlab/paper-MPL-inference).
- epitopes.csv $\to$ epitopes.csv: information about epitopes 
- src-MPL-HIV.tar.gz/\*-poly-seq2state.dat $\to$ input/sequence/\*-poly-seq2state.dat: processed sequences readable by MPL
- src-MPL-HIV.tar.gz/Zanini-extended $\to$ input/Zanini-extended: mutation matrix for HIV data
- processed/\*-index.csv $\to$ notrait/processed/\*-index.csv: information about all sites
- interim/\*-poly.csv $\to$ notrait/interim/\*-poly.csv: information about polymorphic sites, which will be modified to interim/*-poly.csv when finding escape sites

### Software dependencies

Here's an example statement about the need for external software to execute any part of the code: Parts of the analysis are implemented in C++11 and the [GNU Scientific Library](https://www.gnu.org/software/gsl/).

# License

This repository is dual licensed as [GPL-3.0](LICENSE-GPL) (source code) and [CC0 1.0](LICENSE-CC0) (figures, documentation, and our presentation of the data).
